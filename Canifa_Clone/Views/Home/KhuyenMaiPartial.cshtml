@using Canifa_Clone.Models
@model IEnumerable<KhuyenMai>

@if (Model != null && Model.Any())
{
    <div class="container my-5">
        <h2 class="fw-bold text-uppercase mb-4 text-center text-md-start">ƯU ĐÃI NỔI BẬT</h2>

        <div class="row row-cols-1 row-cols-md-2 g-4">
            @foreach (var item in Model)
            {
                <div class="col">
                    <div class="d-flex flex-column justify-content-between p-4 h-100 border rounded shadow-sm"
                         style="background-color: #f8f9fa; border: 1px solid #e9ecef;">

                        <div>
                            <h4 class="fw-bold mb-2 text-dark">@item.TenVoucher</h4>

                            <p class="mb-3 text-secondary" style="font-size: 0.95rem;">
                                @if (!string.IsNullOrEmpty(item.MoTa))
                                {
                                    @item.MoTa
                                }
                                else
                                {
                                    <span>
                                        Giảm @string.Format("{0:N0}", item.GiamGia)đ cho đơn từ @string.Format("{0:N0}", item.DonToiThieu)đ
                                    </span>
                                }
                            </p>
                        </div>

                        <div>
                            <div class="mb-3 text-muted fst-italic" style="font-size: 0.85rem;">
                                <i class="fa-regular fa-clock me-1"></i>
                                HSD: @(item.NgayHetHan.HasValue ? item.NgayHetHan.Value.ToString("dd/MM/yyyy") : "Vô thời hạn")
                            </div>

                            <div class="d-flex justify-content-between align-items-center border-top pt-3">

                                <a href="#" class="text-dark fw-bold text-decoration-none small">
                                    Điều kiện
                                </a>

                                <button class="btn btn-dark px-4 py-2 fw-bold btn-copy-code"
                                        data-code="@item.MaCode"
                                        onclick="copyCode(this)"
                                        style="background-color: #333; font-size: 0.9rem;">
                                    Dùng mã
                                </button>
                            </div>
                        </div>

                    </div>
                </div>
            }
        </div>
    </div>

    <script>
        function copyCode(btn) {
            var code = btn.getAttribute('data-code');
            navigator.clipboard.writeText(code);

            var originalText = btn.innerText;
            btn.innerText = "Đã sao chép";
            btn.classList.remove("btn-dark");
            btn.classList.add("btn-success");

            setTimeout(function () {
                btn.innerText = originalText;
                btn.classList.remove("btn-success");
                btn.classList.add("btn-dark");
            }, 2000);
        }
    </script>
}